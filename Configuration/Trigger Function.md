# REMS2 触发器表达式中函数

|Function	|Desc	|Parameters	|Comments|
|-----------|-------|-----------|--------|
|abschange	|最后两次值的变化绝对值|		|"支持类型：float，int，str，text，log 如果是字符：0 - 值相等； 1 - 值不相等"|
|avg(sec\|#num,<time_shift>)|	指定时间段内，监控项的平均值|	"sec 或者 #num，指定评估时间段（sec是秒，#num是最近值个数）time_shift（可选）评估时间段向前移动的秒"|	"支持类型： float，int示例：avg(#5) 最后5个值的平均 avg(1h) 最近一个小时的平均 avg(1h, 1d) 一天之前的一小时平均		"|
|band(sec\|#num, mask, <time_shift>)|	对监控项的值，执行bit and操作|	"sec（可省略），#num表示最近的第num个值 mask 掩码 64位无符号整型 time_shift …"|	"支持值类型： int 注意： 这里的#num和其他函数中不同，这里指最近的第num个	"|
|change	|最后一个值与倒数第二个值的差|		|"支持类型：float，int，str，text，log For example: (previous value;last value=change) 1;5=+4 3;1=-2 0;-2.5=-2.5 如果是字符：0 - 值相等； 1 - 值不相等"|
|count(sec\|#num, <pattern>, <operator>,<time_shift>)|	指定时间段内，监控项值的个数|	"sec 或者 #num，指定评估时间段（sec是秒，#num是最近值个数）pattern 可选 operator 可选：支持的operator：eq - 相等 ne - 不相等 gt - 大于 ge - 大于等于 lt - 小于 le - 小于等于 like - 匹配 pattern (case-sensitive) band - bitwise AND regexp - 大小写敏感的正则表达式匹配 匹配的正则表达式由 pattern提供 iregexp - 大小写不敏感的正则表达式匹配 匹配的正则表达式由 pattern提供 注意：eq (default), ne, gt, ge, lt, le, band, regexp, iregexp支持int型监控项 eq (default), ne, gt, ge, lt, le, regexp, iregexp 支持 float 监控项 like (default), eq, ne, egexp, iregexp 支持 string, text and log 型监控项 time_shift（可选），同avg()|"	"支持的数据类型： float, integer, string, text, log float精度： 0.000001 如果第三个参数operator是band，第二个参数pattern需要是以’/‘ 分隔的两个数字： [number_to_compare_with]/[mask], 先把监控项值与mask做bit and，其结果与number_to_compare_with对比，如果相等这个监控项值被count函数计数。如果number_to_compare_with和mask相等，则pattern中只需要提供mask值（不需要’/‘) 如果operator参数是regexp或者iregexp，pattern参数是常规正则表达式或者系统中预定义的全局正则表达式(@符号开头) Examples: ⇒ count(10m) → 最后十分钟，监控项值个数 ⇒ count(10m,"error",eq) → 最后十分钟，监控项值等于error的个数 ⇒ count(10m,12) → 最后十分钟，监控项值等于12的个数 ⇒ count(10m,12,gt) → 最后十分钟，监控项值大于12的个数 ⇒ count(#10,12,gt) → 最后十个监控项值中，大于12的个数⇒ count(10m,12,gt,1d) → 一天之前的这10分钟，监控项值大于12的个数 ⇒ count(10m,6/7,band) → 最后十分钟，监控项值最后三个bit位为110的值个数. ⇒ count(10m,,,1d) → 一天前的这十分钟里，监控项值个数"|